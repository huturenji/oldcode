var __extends=this&&this.__extends||function(){var r=function(t,e){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)};return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}(),BigInteger=require("jsbn").BigInteger;function bigIntToMinTwosComplementsHex(t){if("-"!==(i=t.toString(16)).substr(0,1))i.length%2==1?i="0"+i:i.match(/^[0-7]/)||(i="00"+i);else{for(var e=i.substr(1).length,n=(e%2==1?e+=1:i.match(/^[0-7]/)||(e+=2),""),r=0;r<e;r++)n+="f";var i=new BigInteger(n,16).xor(t).add(BigInteger.ONE).toString(16).replace(/^-/,"")}return i}var ASN1Object=function(){function t(){this.isModified=!0,this.hTLV=null,this.hT="00",this.hL="00",this.hV=""}return t.prototype.getLengthHexFromValue=function(){var t=this.hV.length/2,e=t.toString(16);return e.length%2==1&&(e="0"+e),t<128?e:(128+e.length/2).toString(16)+e},t.prototype.getEncodedHex=function(){return null!=this.hTLV&&!this.isModified||(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},t.prototype.getFreshValueHex=function(){return""},t}(),DERInteger=function(n){function t(t){var e=n.call(this)||this;return e.hT="02",t&&t.bigint&&(e.hTLV=null,e.isModified=!0,e.hV=bigIntToMinTwosComplementsHex(t.bigint)),e}return __extends(t,n),t.prototype.getFreshValueHex=function(){return this.hV},t}(ASN1Object),DERSequence=function(n){function t(t){var e=n.call(this)||this;return e.hT="30",e.asn1Array=[],t&&t.array&&(e.asn1Array=t.array),e}return __extends(t,n),t.prototype.getFreshValueHex=function(){for(var t="",e=0;e<this.asn1Array.length;e++)t+=this.asn1Array[e].getEncodedHex();return this.hV=t,this.hV},t}(ASN1Object);function getByteLengthOfL(t,e){return"8"!==t.substring(e+2,e+3)?1:0===(t=parseInt(t.substring(e+3,e+4),10))?-1:0<t&&t<10?t+1:-2}function getHexOfL(t,e){var n=getByteLengthOfL(t,e);return n<1?"":t.substring(e+2,e+2+2*n)}function getIntOfL(t,e){t=getHexOfL(t,e);return""===t?-1:(parseInt(t.substring(0,1),10)<8?new BigInteger(t,16):new BigInteger(t.substring(2),16)).intValue()}function getStartPosOfV(t,e){t=getByteLengthOfL(t,e);return t<0?t:e+2*(t+1)}function getHexOfV(t,e){var n=getStartPosOfV(t,e),e=getIntOfL(t,e);return t.substring(n,n+2*e)}function getPosOfNextSibling(t,e){return getStartPosOfV(t,e)+2*getIntOfL(t,e)}function getPosArrayOfChildren(t,e){for(var n=[],r=getStartPosOfV(t,e),i=(n.push(r),getIntOfL(t,e)),o=r,s=0;;){var u=getPosOfNextSibling(t,o);if(null==u||2*i<=u-r)break;if(200<=s)break;n.push(u),o=u,s++}return n}module.exports={encodeDer:function(t,e){t=new DERInteger({bigint:t}),e=new DERInteger({bigint:e});return new DERSequence({array:[t,e]}).getEncodedHex()},decodeDer:function(t){var e=getPosArrayOfChildren(t,0),n=e[0],e=e[1],n=getHexOfV(t,n),t=getHexOfV(t,e);return{r:new BigInteger(n,16),s:new BigInteger(t,16)}}};