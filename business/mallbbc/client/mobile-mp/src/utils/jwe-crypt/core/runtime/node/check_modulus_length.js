"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.setModulusLength=exports.weakMap=void 0,exports.weakMap=new WeakMap;var getLength=function(e,t){if(0!=(128&(n=e.readUInt8(1))))for(var r=127&n,a=n=0;a<r;a++)var n=(n<<=8)|e.readUInt8(2+a);return 0===t?n:getLength(e.subarray(2+n),t-1)},getLengthOfSeqIndex=function(e,t){var r=e.readUInt8(1);return getLength(0==(128&r)?e.subarray(2):e.subarray(2+(127&r)),t)},getModulusLength=function(e){var t;return exports.weakMap.has(e)?exports.weakMap.get(e):(t=null!=(t=null==(t=e.asymmetricKeyDetails)?void 0:t.modulusLength)?t:getLengthOfSeqIndex(e.export({format:"der",type:"pkcs1"}),"private"===e.type?1:0)-1<<3,exports.weakMap.set(e,t),t)},setModulusLength=function(e,t){exports.weakMap.set(e,t)};exports.setModulusLength=setModulusLength,exports.default=function(e,t){if(getModulusLength(e)<2048)throw new TypeError("".concat(t," requires key modulusLength to be 2048 bits or larger"))};